<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro Civil | Los Andes RP Cloud</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --institucional: #003366; --dorado-civil: #b08d57; --fondo-gris: #f4f7f6;
            --rojo-alerta: #c0392b; --verde-exito: #27ae60; --blanco: #ffffff;
            --sombra: 0 10px 30px rgba(0,0,0,0.15);
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { background-color: var(--fondo-gris); color: #333; font-family: 'Roboto', sans-serif; min-height: 100vh; }
        header { 
            background: var(--institucional); color: var(--blanco); padding: 20px; 
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 5px solid var(--dorado-civil); box-shadow: var(--sombra);
        }
        header h1 { font-family: 'Montserrat', sans-serif; font-size: 1.2rem; text-transform: uppercase; font-weight: 800; }
        .dashboard-nav { background: #e2e8f0; display: flex; justify-content: center; border-bottom: 2px solid #cbd5e1; }
        .tab-btn {
            background: none; border: none; padding: 18px 25px; cursor: pointer;
            font-weight: 800; color: #475569; transition: 0.3s;
            border-bottom: 4px solid transparent; text-transform: uppercase; font-size: 0.75rem;
        }
        .tab-btn.active { color: var(--institucional); border-bottom: 4px solid var(--institucional); background: #fff; }
        .container { max-width: 1000px; margin: 30px auto; padding: 0 20px; }
        .card { 
            background: var(--blanco); border-radius: 12px; padding: 35px; 
            box-shadow: var(--sombra); margin-bottom: 25px; border-top: 8px solid var(--dorado-civil);
        }
        .dni-card {
            background: linear-gradient(135deg, #ffffff 0%, #f1f5f9 100%);
            border: 2px solid #cbd5e1; border-radius: 15px; padding: 25px; 
            display: flex; gap: 20px; position: relative; overflow: hidden; margin-bottom: 20px;
        }
        .dni-card::after {
            content: "LOS ANDES RP"; position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%) rotate(-25deg);
            font-size: 3rem; color: rgba(0,0,0,0.03); font-weight: 900; pointer-events: none;
        }
        .dni-photo { width: 140px; height: 180px; border: 4px solid #fff; box-shadow: 0 5px 15px rgba(0,0,0,0.1); border-radius: 5px; z-index: 2; background: #cbd5e1; flex-shrink: 0; overflow: hidden; }
        .dni-photo img { width: 100%; height: 100%; object-fit: cover; }
        .dni-info { z-index: 2; flex-grow: 1; }
        .dni-info h2 { font-size: 1.1rem; color: var(--institucional); border-bottom: 2px solid var(--dorado-civil); margin-bottom: 10px; padding-bottom: 5px; }
        .dni-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .dni-item label { display: block; font-size: 0.6rem; color: #64748b; font-weight: 800; text-transform: uppercase; }
        .dni-item p { font-size: 0.9rem; font-weight: 700; color: #1e293b; }
        .record-item {
            padding: 15px; border-radius: 10px; border: 1px solid #e2e8f0; margin-bottom: 10px;
            display: flex; justify-content: space-between; align-items: center; background: #f8fafc; border-left: 6px solid var(--institucional);
        }
        .btn { padding: 12px 20px; border-radius: 6px; border: none; font-weight: 700; cursor: pointer; transition: 0.2s; font-family: 'Montserrat', sans-serif; text-transform: uppercase; font-size: 0.7rem; display: inline-flex; align-items: center; gap: 6px; }
        .btn-primario { background: var(--institucional); color: white; }
        .btn-staff { background: var(--dorado-civil); color: white; }
        .btn-peligro { background: var(--rojo-alerta); color: white; }
        .btn-sm { padding: 6px 10px; font-size: 0.6rem; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 800; font-size: 0.8rem; color: var(--institucional); }
        input, select, textarea { width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-family: inherit; }
        .hidden { display: none !important; }
        #modalContainer { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(15, 23, 42, 0.9); display: none; z-index: 1000; align-items: center; justify-content: center; padding: 20px; }
        .modal-body { background: #fff; width: 100%; max-width: 900px; border-radius: 12px; padding: 30px; max-height: 90vh; overflow-y: auto; }
        .account-box { background: #1e293b; color: #38bdf8; padding: 15px; border-radius: 8px; margin: 10px 0; font-family: monospace; border-left: 5px solid #38bdf8; }
        .management-section { margin-top: 15px; padding-top: 15px; border-top: 1px dashed #cbd5e1; }
        .management-title { font-weight: 800; font-size: 0.75rem; color: var(--institucional); margin-bottom: 10px; display: block; text-transform: uppercase;}
    </style>
</head>
<body>

<header>
    <h1>üèõ REGISTRO CIVIL - LOS ANDES RP</h1>
    <div style="display: flex; gap: 10px;">
        <div id="panelOptions" class="hidden">
            <button class="btn btn-staff" onclick="gateKeep('staff')">STAFF</button>
            <button class="btn btn-primario" onclick="gateKeep('policial')">POLICIAL</button>
        </div>
        <button id="btnLogout" class="btn btn-peligro hidden" onclick="location.reload()">SALIR</button>
    </div>
</header>

<div class="dashboard-nav hidden" id="dashNav">
    <button class="tab-btn active" onclick="switchTab('tabDni', this)">Identidad</button>
    <button class="tab-btn" onclick="switchTab('tabVehiculos', this)">Veh√≠culos</button>
    <button class="tab-btn" onclick="switchTab('tabAntecedentes', this)">Antecedentes</button>
</div>

<div class="container">
    <div id="viewLogin" class="card">
        <h2 style="text-align: center; margin-bottom: 25px;">ACCESO AL PORTAL</h2>
        <div class="form-group"><label>USUARIO DISCORD</label><input type="text" id="logUser" placeholder="Nombre#0000"></div>
        <div class="form-group"><label>CONTRASE√ëA</label><input type="password" id="logPass"></div>
        <button class="btn btn-primario" style="width: 100%;" onclick="login()">INGRESAR</button>
        <p style="text-align: center; margin-top: 20px; font-size: 0.8rem;">¬øSin cuenta? <a href="#" onclick="toggleAuth(false)" style="color:var(--dorado-civil); font-weight:800">Registrarse</a></p>
    </div>

    <div id="viewRegister" class="card hidden">
        <h2 style="text-align: center; margin-bottom: 25px;">REGISTRO</h2>
        <div class="form-group"><label>USUARIO DISCORD</label><input type="text" id="regUser"></div>
        <div class="form-group"><label>CONTRASE√ëA</label><input type="password" id="regPass"></div>
        <button class="btn btn-staff" style="width: 100%;" onclick="register()">CREAR CUENTA</button>
        <p style="text-align: center; margin-top: 20px;"><a href="#" onclick="toggleAuth(true)">Volver</a></p>
    </div>

    <div id="viewCreateDni" class="card hidden">
        <h2>DATOS DEL CIUDADANO</h2>
        <div class="dni-grid" style="margin-top:20px">
            <div class="form-group"><label>NOMBRE IC COMPLETO</label><input type="text" id="fNombre"></div>
            <div class="form-group"><label>USUARIO ROBLOX</label><input type="text" id="fRoblox"></div>
            <div class="form-group"><label>NACIONALIDAD</label><input type="text" id="fNac" value="Chilena"></div>
            <div class="form-group"><label>FECHA NACIMIENTO</label><input type="date" id="fFecha"></div>
        </div>
        <div class="form-group"><label>FOTO DE PERFIL (GALER√çA)</label><input type="file" accept="image/*" id="fFoto" onchange="processFile(this)"></div>
        <button class="btn btn-primario" style="width: 100%;" onclick="saveDni()">GENERAR IDENTIDAD</button>
    </div>

    <div id="viewMain" class="hidden">
        <div id="tabDni"></div>
        <div id="tabVehiculos" class="hidden"><div class="card"><h3>MIS PROPIEDADES</h3><div id="userVehList"></div></div></div>
        <div id="tabAntecedentes" class="hidden"><div class="card"><h3>HISTORIAL JUDICIAL</h3><div id="userAntList"></div></div></div>
    </div>

    <div id="viewStaff" class="card hidden">
        <div style="display:flex; justify-content:space-between; align-items:center">
            <h2 style="color: var(--dorado-civil);">PANEL STAFF</h2>
            <button class="btn btn-primario btn-sm" onclick="showView('viewMain')">VOLVER A MI DNI</button>
        </div>
        <input type="text" placeholder="Buscar..." onkeyup="search(this, 'staff')" style="margin:20px 0">
        <div id="staffList"></div>
    </div>

    <div id="viewPolicial" class="card hidden">
        <div style="display:flex; justify-content:space-between; align-items:center">
            <h2 style="color: var(--institucional);">PANEL POLICIAL</h2>
            <button class="btn btn-primario btn-sm" onclick="showView('viewMain')">VOLVER A MI DNI</button>
        </div>
        <input type="text" placeholder="Buscar..." onkeyup="search(this, 'policial')" style="margin:20px 0">
        <div id="policeList"></div>
    </div>

    <div id="viewAddVeh" class="card hidden">
        <h3 id="vehFormTitle">ASIGNAR VEH√çCULO</h3>
        <div class="dni-grid" style="margin-top:20px">
            <input type="text" id="vMa" placeholder="Marca">
            <input type="text" id="vMo" placeholder="Modelo">
            <input type="text" id="vPa" placeholder="Patente">
            <input type="text" id="vCo" placeholder="Color">
            <input type="number" id="vAn" placeholder="A√±o">
            <div class="form-group"><label>Fecha de Registro</label><input type="date" id="vFe"></div>
        </div>
        <button class="btn btn-primario" onclick="dbActionVeh()">GUARDAR VEH√çCULO</button>
        <button class="btn" onclick="showView('viewStaff')">CANCELAR</button>
    </div>

    <div id="viewAddAnt" class="card hidden">
        <h3>REPORTAR CARGO JUDICIAL</h3>
        <input type="text" id="aDe" placeholder="Articulo / Delito">
        <textarea id="aDesc" placeholder="Descripci√≥n detallada..."></textarea>
        <input type="number" id="aMu" placeholder="Monto ($)">
        <input type="date" id="aFe">
        <select id="aEs"><option value="Pendiente">Pendiente</option><option value="Pagado">Pagado</option></select>
        <button class="btn btn-peligro" onclick="dbSaveAnt()">SUBIR ANTECEDENTE</button>
        <button class="btn" style="margin-top:10px; width:100%" onclick="closeModal(); showView('viewPolicial')">CANCELAR</button>
    </div>
</div>

<div id="modalContainer">
    <div class="modal-body"><div id="modalContent"></div><button class="btn btn-peligro" style="width:100%; margin-top:20px" onclick="closeModal()">CERRAR VENTANA</button></div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

    // --- CONFIGURACI√ìN FIREBASE (TUS DATOS YA CARGADOS) ---
    const firebaseConfig = {
        apiKey: "AIzaSyD_sZ8J9hap9f5sGVjQqABAcZUCOzgRl7o",
        authDomain: "losandesrp-dee74.firebaseapp.com",
        databaseURL: "https://losandesrp-dee74-default-rtdb.firebaseio.com",
        projectId: "losandesrp-dee74",
        storageBucket: "losandesrp-dee74.firebasestorage.app",
        messagingSenderId: "883239257395",
        appId: "1:883239257395:web:7948a683127d39af3caa46",
        measurementId: "G-53273LPBLR"
    };

    const app = initializeApp(firebaseConfig);
    const fdb = getDatabase(app);

    // --- VARIABLES GLOBALES (UNIDAS A WINDOW PARA ACCESO DESDE HTML) ---
    window.db = { users: [], dnis: [] };
    window.curUser = null; 
    window.curImg = "https://via.placeholder.com/150"; 
    window.curTarget = null;
    window.editingVehIdx = null;

    // --- SINCRONIZACI√ìN EN TIEMPO REAL ---
    onValue(ref(fdb, 'andes_data/'), (snapshot) => {
        const data = snapshot.val();
        if (data) {
            window.db = data;
            if(!window.db.users) window.db.users = [];
            if(!window.db.dnis) window.db.dnis = [];
            if(window.curUser) window.renderDash();
        }
    });

    window.saveToCloud = () => set(ref(fdb, 'andes_data/'), window.db);
    const genRUT = () => `${Math.floor(Math.random()*25)}.${Math.floor(Math.random()*999)}.${Math.floor(Math.random()*999)}-${Math.floor(Math.random()*9)}`;

    // --- FUNCIONES DE AUTENTICACI√ìN Y VISTAS ---
    window.processFile = (i) => {
        if (!i.files[0]) return;
        const r = new FileReader();
        r.onload = e => window.curImg = e.target.result;
        r.readAsDataURL(i.files[0]);
    };

    window.toggleAuth = (l) => {
        document.getElementById('viewLogin').classList.toggle('hidden', !l);
        document.getElementById('viewRegister').classList.toggle('hidden', l);
    };

    window.register = () => {
        const u = document.getElementById('regUser').value;
        const p = document.getElementById('regPass').value;
        if(!u || !p) return alert("Completa los campos.");
        if(window.db.users.find(x => x.user === u)) return alert("Usuario ya existe.");
        window.db.users.push({ user: u, pass: btoa(p) });
        window.saveToCloud(); alert("Cuenta creada exitosamente."); window.toggleAuth(true);
    };

    window.login = () => {
        const u = document.getElementById('logUser').value;
        const p = btoa(document.getElementById('logPass').value);
        const user = window.db.users.find(x => x.user === u && x.pass === p);
        if(user) {
            window.curUser = user;
            document.getElementById('btnLogout').classList.remove('hidden');
            document.getElementById('panelOptions').classList.remove('hidden');
            const dni = window.db.dnis.find(d => d.discord === u);
            dni ? (window.showView('viewMain'), window.renderDash()) : window.showView('viewCreateDni');
        } else alert("Credenciales inv√°lidas.");
    };

    window.saveDni = () => {
        const nom = document.getElementById('fNombre').value;
        const rob = document.getElementById('fRoblox').value;
        if(!nom || !rob) return alert("Nombre y Roblox son obligatorios.");
        const nuevoDni = {
            id: Date.now(),
            discord: window.curUser.user,
            nombre: nom,
            roblox: rob,
            rut: genRUT(),
            nacionalidad: document.getElementById('fNac').value || "Chilena",
            fecha: document.getElementById('fFecha').value || "2000-01-01",
            foto: window.curImg,
            licencias: [], vehiculos: [], antecedentes: []
        };
        window.db.dnis.push(nuevoDni);
        window.saveToCloud();
        window.showView('viewMain');
    };

    window.showView = (id) => {
        document.querySelectorAll('.container > div, .dashboard-nav').forEach(v => v.classList.add('hidden'));
        document.getElementById(id).classList.remove('hidden');
        if(id === 'viewMain') {
            document.getElementById('dashNav').classList.remove('hidden');
            window.renderDash();
        }
    };

    window.switchTab = (t, b) => {
        ['tabDni', 'tabVehiculos', 'tabAntecedentes'].forEach(x => document.getElementById(x).classList.add('hidden'));
        document.querySelectorAll('.tab-btn').forEach(x => x.classList.remove('active'));
        document.getElementById(t).classList.remove('hidden');
        b.classList.add('active');
    };

    const getDniHTML = (d) => `
        <div class="dni-card">
            <div class="dni-photo"><img src="${d.foto}"></div>
            <div class="dni-info">
                <h2>C√âDULA DE IDENTIDAD</h2>
                <div class="dni-grid">
                    <div class="dni-item"><label>Nombre</label><p>${d.nombre}</p></div>
                    <div class="dni-item"><label>RUT</label><p>${d.rut}</p></div>
                    <div class="dni-item"><label>Roblox</label><p>${d.roblox}</p></div>
                    <div class="dni-item"><label>Nacionalidad</label><p>${d.nacionalidad}</p></div>
                </div>
                <div style="margin-top:10px; font-size:0.75rem"><b>LICENCIAS:</b> ${d.licencias?.join(', ') || 'Ninguna'}</div>
            </div>
        </div>`;

    window.renderDash = () => {
        const d = window.db.dnis.find(x => x.discord === window.curUser.user);
        if(!d) return;
        document.getElementById('tabDni').innerHTML = getDniHTML(d);
        document.getElementById('userVehList').innerHTML = d.vehiculos?.map(v => `<div class="record-item"><div><b>${v.ma} ${v.mo}</b><br>Patente: ${v.pa}</div><span class="btn-sm ${v.es==='Retenido'?'btn-peligro':'btn-primario'}" style="border-radius:20px; padding:2px 10px">${v.es}</span></div>`).join('') || "Sin veh√≠culos registrados.";
        document.getElementById('userAntList').innerHTML = d.antecedentes?.map(a => `<div class="record-item"><div><b>${a.de}</b><br>$${a.mu}</div><span class="btn-sm ${a.es==='Pagado'?'btn-primario':'btn-peligro'}" style="border-radius:20px; padding:2px 10px">${a.es}</span></div>`).join('') || "Sin antecedentes. Ciudadano ejemplar.";
    };

    // --- PANELES DE GESTI√ìN ---
    window.gateKeep = (p) => {
        const pass = prompt("ACCESO RESTRINGIDO - INGRESE CLAVE:");
        if(p === 'staff' && pass === 'StaffLARP') window.showView('viewStaff');
        else if(p === 'policial' && pass === 'InstitucionesPolicialesLARP') window.showView('viewPolicial');
        else alert("Acceso denegado.");
    };

    window.search = (i, p) => {
        const q = i.value.toLowerCase();
        const res = window.db.dnis.filter(d => d.nombre.toLowerCase().includes(q) || d.rut.includes(q) || d.roblox.toLowerCase().includes(q));
        document.getElementById(p === 'staff' ? 'staffList' : 'policeList').innerHTML = res.map(d => `
            <div class="record-item">
                <div><b>${d.nombre}</b><br><small>RUT: ${d.rut} | Roblox: ${d.roblox}</small></div>
                <button class="btn btn-primario btn-sm" onclick="openInspector(${d.id}, '${p}')">GESTIONAR</button>
            </div>`).join('');
    };

    window.openInspector = (id, p) => {
        window.curTarget = id; 
        const d = window.db.dnis.find(x => x.id === id);
        let h = getDniHTML(d);
        if(p === 'staff') {
            h += `<button class="btn btn-staff btn-sm" style="width:100%; margin-bottom:10px" onclick="revealAccount('${d.discord}')">VER DATOS DE CUENTA</button><div id="accountInfo"></div>`;
            h += `<button class="btn btn-peligro btn-sm" style="width:100%; margin-bottom:10px" onclick="deleteDni(${d.id})">BORRAR DNI</button>`;
            h += `<div style="display:flex; gap:2px; flex-wrap:wrap">`;
            ["A1","A2","A3","A4","A5","B","C","D","E","F","Armas"].forEach(l => h += `<button class="btn ${(d.licencias||[]).includes(l)?'btn-primario':'btn'} btn-sm" onclick="toggleLic(${d.id},'${l}')">${l}</button>`);
            h += `</div><button class="btn btn-staff btn-sm" style="width:100%; margin:10px 0" onclick="preVeh(${d.id})">+ ASIGNAR VEH√çCULO</button>`;
            d.vehiculos?.forEach((v, i) => { h += `<div class="record-item"><div><b>${v.ma}</b> [${v.pa}]</div><div style="display:flex; gap:5px"><button class="btn btn-primario btn-sm" onclick="editVeh(${i})">‚úèÔ∏è</button><button class="btn btn-peligro btn-sm" onclick="delVeh(${i})">üóëÔ∏è</button></div></div>`; });
        } else {
            h += `<button class="btn btn-peligro btn-sm" style="width:100%; margin-bottom:10px" onclick="preAnt(${d.id})">+ ANTECEDENTE</button>`;
            h += `<div class="management-section"><span class="management-title">Estado de Veh√≠culos</span>`;
            d.vehiculos?.forEach((v, i) => { h += `<div class="record-item"><div><b>${v.ma}</b> (${v.pa})</div><select onchange="updateVehStatus(${i}, this.value)"><option value="Circulando" ${v.es==='Circulando'?'selected':''}>Circulando</option><option value="Retenido" ${v.es==='Retenido'?'selected':''}>Retenido</option><option value="Encargo por Robo" ${v.es==='Encargo por Robo'?'selected':''}>Encargo por Robo</option></select></div>`; });
            h += `</div><div class="management-section"><span class="management-title">Gesti√≥n Antecedentes</span>`;
            d.antecedentes?.forEach((a, i) => { h += `<div class="record-item"><div><b>${a.de}</b></div><select onchange="updateAntStatus(${i}, this.value)"><option value="Pendiente" ${a.es==='Pendiente'?'selected':''}>Pendiente</option><option value="Pagado" ${a.es==='Pagado'?'selected':''}>Pagado</option></select></div>`; });
            h += `</div>`;
        }
        document.getElementById('modalContent').innerHTML = h;
        document.getElementById('modalContainer').style.display = 'flex';
    };

    window.updateVehStatus = (idx, val) => { window.db.dnis.find(x => x.id === window.curTarget).vehiculos[idx].es = val; window.saveToCloud(); };
    window.updateAntStatus = (idx, val) => { window.db.dnis.find(x => x.id === window.curTarget).antecedentes[idx].es = val; window.saveToCloud(); };
    
    window.revealAccount = (discordUser) => {
        const pass = prompt("CLAVE DE SEGURIDAD MAESTRA:");
        if(pass === "Estrella0703") {
            const acc = window.db.users.find(u => u.user === discordUser);
            document.getElementById('accountInfo').innerHTML = `<div class="account-box"><b>USUARIO:</b> ${acc.user}<br><b>CLAVE:</b> ${acc.pass ? atob(acc.pass) : 'No disponible'}</div>`;
        } else alert("Clave maestra incorrecta.");
    };

    window.toggleLic = (id, l) => { 
        const d = window.db.dnis.find(x => x.id === id); if(!d.licencias) d.licencias = [];
        d.licencias = d.licencias.includes(l) ? d.licencias.filter(x => x !== l) : [...d.licencias, l]; 
        window.saveToCloud(); window.openInspector(id, 'staff'); 
    };

    window.dbActionVeh = () => {
        const d = window.db.dnis.find(x => x.id === window.curTarget); if(!d.vehiculos) d.vehiculos = [];
        const data = { ma: document.getElementById('vMa').value, mo: document.getElementById('vMo').value, pa: document.getElementById('vPa').value, co: document.getElementById('vCo').value, an: document.getElementById('vAn').value, fe: document.getElementById('vFe').value, es: window.editingVehIdx !== null ? d.vehiculos[window.editingVehIdx].es : "Circulando" };
        if(window.editingVehIdx !== null) d.vehiculos[window.editingVehIdx] = data; else d.vehiculos.push(data);
        window.saveToCloud(); window.showView('viewStaff');
    };

    window.dbSaveAnt = () => {
        const d = window.db.dnis.find(x => x.id === window.curTarget); if(!d.antecedentes) d.antecedentes = [];
        d.antecedentes.push({ de: document.getElementById('aDe').value, desc: document.getElementById('aDesc').value, mu: document.getElementById('aMu').value, fe: document.getElementById('aFe').value, es: document.getElementById('aEs').value });
        window.saveToCloud(); window.showView('viewPolicial');
    };

    window.deleteDni = (id) => { if(confirm("¬øSeguro que quieres borrar este DNI de la base de datos?")) { window.db.dnis = window.db.dnis.filter(d => d.id !== id); window.saveToCloud(); window.closeModal(); window.showView('viewStaff'); } };
    window.editVeh = (i) => { window.editingVehIdx = i; const v = window.db.dnis.find(x => x.id === window.curTarget).vehiculos[i]; document.getElementById('vMa').value = v.ma; document.getElementById('vMo').value = v.mo; document.getElementById('vPa').value = v.pa; document.getElementById('vCo').value = v.co; document.getElementById('vAn').value = v.an; document.getElementById('vFe').value = v.fe; window.closeModal(); window.showView('viewAddVeh'); };
    window.delVeh = (i) => { if(confirm("¬øBorrar veh√≠culo?")) { window.db.dnis.find(x => x.id === window.curTarget).vehiculos.splice(i, 1); window.saveToCloud(); window.openInspector(window.curTarget, 'staff'); } };
    window.preVeh = (id) => { window.curTarget = id; window.editingVehIdx = null; window.closeModal(); window.showView('viewAddVeh'); };
    window.preAnt = (id) => { window.curTarget = id; window.closeModal(); window.showView('viewAddAnt'); };
    window.closeModal = () => document.getElementById('modalContainer').style.display = 'none';
</script>
</body>
</html>
